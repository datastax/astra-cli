---- meta ----
command: astra db cqlsh exec two_regions_db - -o json
exit_code: 0
comments: 
 | Can't really test human output since we don't capture cqlsh output for human outputs
 | But at least we can verify the command runs and the exit code is correct
 | (human output returns cqlsh exit code; non-human output returns the cqlsh exit code via a field)
---- output ----
stderr: [INFO] Reading CQL statements from stdin...
stderr: [INFO] Use backslashes for multi-line statements
stdout: {
stdout:   "code" : "OK",
stdout:   "message" : "Cqlsh executed with exit code 1, with 0 lines in stdout and 70 lines in stderr.",
stdout:   "data" : {
stdout:     "exitCode" : 1,
stdout:     "stdout" : "",
stdout:     "stderr" : "Traceback (most recent call last):\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 1348, in do_open\n    h.request(req.get_method(), req.selector, req.data, headers,\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 1303, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 1349, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 1298, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 1058, in _send_output\n    self.send(msg)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 996, in send\n    self.connect()\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 1468, in connect\n    super().connect()\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py\", line 962, in connect\n    self.sock = self._create_connection(\n                ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py\", line 839, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socket.py\", line 974, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/../zipfiles/cassandra-driver-internal-only-3.26.0-df103d3a.zip/cassandra-driver-3.26.0-df103d3a/cassandra/datastax/cloud/__init__.py\", line 138, in read_metadata_info\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 216, in urlopen\n    return opener.open(url, data, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 519, in open\n    response = self._open(req, data)\n               ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 536, in _open\n    result = self._call_chain(self.handle_open, protocol, protocol +\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 496, in _call_chain\n    result = func(*args)\n             ^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 1391, in https_open\n    return self.do_open(http.client.HTTPSConnection, req,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/request.py\", line 1351, in do_open\n    raise URLError(err)\nurllib.error.URLError: <urlopen error [Errno 8] nodename nor servname provided, or not known>\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/dsecqlsh.py\", line 534, in <module>\n    cqlsh.main(*cqlsh.read_options(sys.argv[1:], os.environ))\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/cqlsh.py\", line 2616, in main\n    shell = Shell(hostname,\n            ^^^^^^^^^^^^^^^\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/dsecqlsh.py\", line 367, in __init__\n    conn = cluster_factory(\n           ^^^^^^^^^^^^^^^^\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/../pylib/cqlshlib/driver.py\", line 90, in cluster_factory\n    return _cloud_cluster_factory(whitelist_lbp, **options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/../pylib/cqlshlib/driver.py\", line 120, in _cloud_cluster_factory\n    cluster = Cluster(**options)\n              ^^^^^^^^^^^^^^^^^^\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/../zipfiles/cassandra-driver-internal-only-3.26.0-df103d3a.zip/cassandra-driver-3.26.0-df103d3a/cassandra/cluster.py\", line 1125, in __init__\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/../zipfiles/cassandra-driver-internal-only-3.26.0-df103d3a.zip/cassandra-driver-3.26.0-df103d3a/cassandra/datastax/cloud/__init__.py\", line 92, in get_cloud_config\n  File \"/Users/me/work/astra-cli/.cli_tests_temp/java/cqlsh-astra/bin/../zipfiles/cassandra-driver-internal-only-3.26.0-df103d3a.zip/cassandra-driver-3.26.0-df103d3a/cassandra/datastax/cloud/__init__.py\", line 141, in read_metadata_info\ncassandra.DriverException: Unable to connect to the metadata service at https://e6856687-40e4-4638-a942-946355c6d711-us-west-2.db.astra-dev.datastax.com:29080/metadata. Check the cluster status in the cloud console. "
stdout:   },
stdout:   "nextSteps" : null
stdout: }
---- end ----
